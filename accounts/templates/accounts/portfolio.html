{% extends 'accounts/base.html' %}
{% load static %}
{% block details %}
<div class="flex flex-row items-center justify-between">
    <div>
        <h3 class="md:text-[28px] font-semibold capitalize">Your Portfolio</h3>
        <p class="text-xs text-[#525156] md:hidden">Your added items will be shown here</p>
    </div>
    <a href="{% url 'add-portfolio' %}" class="px-[10px] py-1.5 rounded-md bg-[#EAECEF]">
        <span class="text-xs md:text-base font-medium capitalize">Add items</span>
    </a>
</div>
<div class="h-[1px] bg-[#1e232933] w-full mt-5 md:mt-6"></div>
<div class="overflow-x-auto">
    <table class="min-w-full overflow-x-auto text-left table-fixed mt-5">
        <thead class="w-full text-sm">
            <tr class="">
                <th scope="col" class="space-x-4 whitespace-nowrap text-left text-sm md:text-base font-medium text-[#252C32]">
                    <span class="capitalize">
                        Name
                    </span>
                    <div class="inline-block w-3 h-3">
                        <span data-icon="arrow" class=""></span>
                    </div>
                </th>
                <th scope="col" class="space-x-4 whitespace-nowrap text-sm md:text-base font-medium text-[#252C32] pl-[30px]">
                    <span>
                        Purchase Date
                    </span>
                    <div class="inline-block w-3 h-3">
                        <span data-icon="arrow" class=""></span>
                    </div>
                </th>
                <th scope="col" class="space-x-4 whitespace-nowrap text-sm md:text-base font-medium text-[#252C32] pl-[30px]">
                    <span>
                        Purchase Price
                    </span>
                    <div class="inline-block w-3 h-3">
                        <span data-icon="arrow" class=""></span>
                    </div>
                </th>
                <th scope="col" class="space-x-4 whitespace-nowrap text-sm md:text-base font-medium text-[#252C32] pl-[30px]">
                    <span>
                        Market Value
                    </span>
                    <div class="inline-block w-3 h-3">
                        <span data-icon="arrow" class=""></span>
                    </div>
                </th>
                <th scope="col" class="space-x-4 whitespace-nowrap text-sm md:text-base font-medium text-[#252C32] pl-[30px]">
                    <span>
                        Gain/Loss
                    </span>
                    <div class="inline-block w-3 h-3">
                        <span data-icon="arrow" class=""></span>
                    </div>
                </th>
            </tr>
        </thead>
        <div class="pt-7">
            <tbody class="bg-white divide-y divide-gray-200">
                {% for portfolio in items %}
                {% with portfolio.card as card %}
                <tr class="text-[#525156]">
                    <td class="text-xs md:text-base whitespace-nowrap py-2 max-w-24 truncate">
                        {{ card.name  }}</td>
                    <td class="text-xs md:text-base whitespace-nowrap pl-[30px]">{{ portfolio.purchase_date }}
                    </td>
                    <td class="text-xs md:text-base whitespace-nowrap pl-[30px]">${{ portfolio.purchase_price }}
                    </td>
                    <td class="text-xs md:text-base whitespace-nowrap pl-[30px]">${{ portfolio.market_value }}
                    </td>
                    {% if portfolio.gain_or_loss < 0 %}
                        <!-- <td class="text-red-600 px-3 py-4 text-sm text-center whitespace-nowrap">--({{ portfolio.gain_or_loss_percentage|floatformat:2 }}%)</td> -->
                        <td class="text-[#E2464A] text-xs md:text-base whitespace-nowrap pl-[30px]">--({{ portfolio.gain_or_loss_percentage|floatformat:2 }}%)
                        </td>
                    {% else %}
                        <!-- <td class="px-3 py-4 text-sm text-[#16A34A] text-center whitespace-nowrap">${{ portfolio.gain_or_loss|floatformat:2 }} ({{ portfolio.gain_or_loss_percentage|floatformat:2 }}%)</td> -->
                        <td class="text-[#16A34A] text-xs md:text-base whitespace-nowrap pl-[30px]">${{ portfolio.gain_or_loss|floatformat:2 }} ({{ portfolio.gain_or_loss_percentage|floatformat:2 }}%)
                        </td>
                    {% endif %}
                </tr>
                {% endwith %}
                {% endfor %}
            </tbody>
        </div>
    </table>
</div>
<div class="h-[1px] bg-[#1e232933] w-full mt-1"></div>
<div>
    <p class="font-semibold mt-[30px]">Total portfolio over time</p>
    <div class="flex flex-col-reverse md:grid md:grid-cols-2 md:place-items-center">
        <div class="w-full grid place-items-center">
            <canvas class="mt-2 height-[200px] md:height-[800px] w-full" id="myChart"></canvas>
        </div>
        <div class="grid gap-y-4 mt-5">
            <div class="flex border border-1 border-[#DDE2E4] rounded-md px-[30px] py-4 md:py-6">
                <div class="flex items-center w-1/2 gap-x-4">
                    <div class="relative w-[36px] h-[36px] md:w-[56px] md:h-[56px]">
                        <canvas id="gain-chart" width="400" height="400"></canvas>
                        <img class="centered-element w-4 h-4" src="{% static 'icons/gain.svg' %}" />
                    </div>
                    <div>
                        <p id="gain-in-rev" class="text-[18px] md:text-[28px] font-semibold"></p>
                        <p class="text-xs md:text-[20px] font-normal text-[#525156]">Gain in revenue</p>
                    </div>
                </div>
                <div class="flex items-center w-1/2 gap-x-4">
                    <div class="relative w-[36px] h-[36px] md:w-[56px] md:h-[56px]">
                        <canvas id="loss-chart" width="400" height="400"></canvas>
                        <img class="centered-element w-4 h-4" src="{% static 'icons/loss.svg' %}" />
                    </div>
                    <div>
                        <p id="loss-in-rev" class="text-[18px] md:text-[28px] font-semibold"></p>
                        <p class="text-xs md:text-[20px] font-normal text-[#525156]">Loss in revenue</p>
                    </div>
                </div>
            </div>
            <div class="flex justify-between border border-1 border-[#DDE2E4] rounded-md px-[30px] py-4 md:py-6 items-center">
                <p class="font-semibold md:text-2xl">Purchase Items</p>
                <p class="text-2xl md:text-[40px] font-semibold md:font-normal">{{ items|length }}</p>
            </div>
            <div class="flex justify-between border border-1 border-[#DDE2E4] rounded-md px-[30px] py-4 md:py-6 items-center">
                <p class="font-semibold md:text-2xl">Market Price</p>
                <p class="text-2xl md:text-[40px] font-semibold md:font-normal">$200</p>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'js/portfolio.js' %}"></script>
{% endblock %}
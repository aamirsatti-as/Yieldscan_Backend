{% extends 'accounts/base.html' %}
{% load static %}
{% block details %}
{% load component_tags %}
<div class="flex flex-row items-center justify-between">
    <div>
        <h3 class="md:text-[32px] font-semibold capitalize">All Favorites</h3>
        <span class="text-xs md:text-xl font-medium text-[#525156]">{{ cards|length }} Items</span>
    </div>
</div>
<div class="h-[1px] bg-[#1e232933] w-full mt-5 md:mt-6 md:hidden"></div>
<div class="flex flex-row items-center justify-end mt-4">
    <div class="flex flex-row items-center justify-between gap-5">
        <span class="text-sm font-normal hidden md:block">Sort by:</span>
        <div x-data="{ isModalOpen: false }"
            class="z-[1000] flex flex-row items-center justify-between border px-2 md:p-4 py-1.5 md:w-[200px] gap-x-1.5 md:gap-x-16 rounded-md md:rounded-none relative">
            <span class="text-xs md:text-base font-normal capitalize"><span class="md:hidden inline">Sort: </span>Featured</span>
            <button @click="isModalOpen = true" class="w-3 h-3">
                <img class="md:hidden" src="{% static 'icons/sort.svg' %}" />
                <img class="hidden md:block" src="{% static 'images/arrow.svg' %}" />
            </button>
            <div x-show="isModalOpen" @click.away="isModalOpen = false" x-transition
                class="absolute right-0 space-y-2.5 z-10 rounded-md shadow-lg top-[30px] md:top-12 h-48 w-[200px] bg-white py-2">
                <nav class="flex flex-col items-start justify-start border">
                    <button onclick="updateSortParam('-added_on')" class="capitalize font-medium text-sm text-[#525156] px-4 py-2">Recently Added </button>
                    <button onclick="updateSortParam('-price')" class="capitalize font-medium text-sm text-[#525156] px-4 py-2">Price High to Low </button>
                    <button onclick="updateSortParam('price')" class="capitalize font-medium text-sm text-[#525156] px-4 py-2">Price Low to High </button>
                    <button onclick="updateSortParam('name')" class="capitalize font-medium text-sm text-[#525156] px-4 py-2">Name A-Z </button>
                    <button onclick="updateSortParam('-name')" class="capitalize font-medium text-sm text-[#525156] px-4 py-2">Name Z-A </button>
                </nav>
            </div>
        </div>
    </div>
</div>
<div id="favouite-cards" class="hidden md:grid md:grid-cols-2 lg:grid-cols-3 mt-5 gap-x-3 gap-y-5">
    {% if cards|length == 0 %}
    <div class="col-span-2">
        <p class="text-left">No favorites</p>
    </div>
    {% else %}
    {% for card in cards %}
        {% component "card" card=card is_favorite=True / %}
    {% endfor %}
    {% endif %}
</div>
<script>
    function updateSortParam(param) {
        const params = new URLSearchParams(window.location.search);
        params.delete("sort");
        params.set("sort", param);
        window.location.search = params.toString();
    }
</script>
{% endblock %}
{% block details_raw %}
<div id="favouite-cards" class="md:hidden grid grid-cols-2 mt-5">
    {% if cards|length == 0 %}
    <div class="col-span-2">
        <p class="text-left">No favorites</p>
    </div>
    {% else %}
    {% for card in cards %}
        {% component "card" card=card is_favorite=True / %}  
    {% endfor %}
    {% endif %}
</div>
{% with pagination.params as params %}
<div id="pagination" class="md:hidden flex justify-center w-full mt-4 mb-8 items-center gap-2">
    {% if pagination.has_prev %}
    <a href="?page={{ pagination.page|add:-1 }}&limit={{ pagination.limit }}&{{ params }}" class="w-3 h-3 rounded-full border border-1"><img src="{% static 'icons/arrow-left.svg' %}" /></a>
    {% else %}
    <a class="w-3 h-3 rounded-full border border-1 border-[#E4E7E9]"><img src="{% static 'icons/arrow-left.svg' %}" /></a>
    {% endif %}
    {% for num in pagination.page_range %}
    {% if num == pagination.page %}
    <div class="w-5 h-5 rounded-full bg-[#F6D658] grid place-items-center"><p class="text-xs font-semibold">{{ num }}</p></div>
    {% else %}
    <a href="?page={{ num }}&limit={{ pagination.limit }}&{{ params }}" class="border-[#E4E7E9] border border-1 w-5 h-5 rounded-full grid place-items-center"><p class="text-xs font-normal">{{ num }}</p></a>
    {% endif %}
    {% endfor %}
    {% if pagination.has_next %}
    <a href="?page={{ pagination.page|add:1 }}&limit={{ pagination.limit }}&{{ params }}" class="w-3 h-3 rounded-full border border-1"><img src="{% static 'icons/arrow-right.svg' %}" /></a>
    {% else %}
    <a class="w-3 h-3 rounded-full border border-1 border-[#E4E7E9]"><img src="{% static 'icons/arrow-right.svg' %}" /></a>
    {% endif %}
</div>
{% endwith %}
<script src="{% static 'js/toggleCardFavorite.js' %}"></script>
{% endblock %}